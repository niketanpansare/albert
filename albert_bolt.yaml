# config file for training the DNN model on Turi Bolt
# note: fill in your own simcloud authentication token
name: 'AMP Reco Engineering - Train Albert'
description: 'Job for training a DNN model for Arcade'
command: 'python3 -m bolt_train'
tags: ['AMP', 'Recommendations', 'BERT', 'Dev']
setup_command: 'python3 -m pip install apple-certifi --upgrade --force-reinstall -i https://pypi.apple.com/simple' #'bash setup_bolt.sh'
permissions:
   owners: 'niketan_pansare'
   viewers: 'amp-reco-eng'
resources:
  docker_image: docker.apple.com/htokgozoglu/yoda:latest #image: current-ubuntu18.04-cuda10.1
  ports: ["TENSORBOARD_PORT"]
  num_gpus: 4
  num_cpus: 2
  memory_gb: 150 #95 as the RAM usage is close 80-90% and might cause swapping
  disk_gb: 800
  timeout: 7d
environment_variables:
  CUDA_HOME: '/usr/local/cuda'
  LD_LIBRARY_PATH: '$LD_LIBRARY_PATH:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64'
  TF_FORCE_GPU_ALLOW_GROWTH: 'true'
parameters:
  model: 'albert_base'